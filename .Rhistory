roc_curve(survived, .pred_Yes) %>%
autoplot()
log_result %>%
roc_auc(survived, .pred_Yes) # calculate the area under the roc curve
library(tidymodels)
library(tidymodels)
tidymodels_prefer()
df <- read.csv('/Users/wentaoyu/Documents/UCSB File/Stats/Pstat131/HWs/homework-3/data/titanic.csv') %>%
mutate(survived = factor(survived,
levels = c("Yes", "No")),
pclass = factor(pclass))
df <- read.csv('/Users/wentaoyu/Documents/UCSB File/Stats/Pstat131/HWs/homework-3/data/titanic.csv') %>%
mutate(survived = factor(survived,
levels = c("Yes", "No")),
pclass = factor(pclass))
set.seed(891) # keep the outcome stable
titanic_split <- initial_split(df, prop = 0.80, strata = survived) # split the data and stratified on survived
titanic_training <- training(titanic_split) # extract the training data
titanic_testing <- testing(titanic_split) # extract the testing data
titanic_fold <- vfold_cv(titanic_training, 10)
titanic_fold <- vfold_cv(titanic_training, 10)
titanic_fold
titanic_recipe <- recipe(survived ~ pclass+sex+age+sib_sp+parch+fare, data = titanic_training) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms = ~ starts_with('sex'):fare+
age:fare)
summary(titanic_recipe)
log_reg <- logistic_reg() %>%
set_engine('glm') %>%
set_mode('classification')
log_wf <- workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit <- fit(log_wf, titanic_training)
lda_mode <- discrim_linear() %>%
set_engine('MASS') %>%
set_mode('classification')
lda_wf <- workflow() %>%
add_model(lda_mode) %>%
add_recipe(titanic_recipe)
lda_fit <- fit(lda_wf, titanic_training)
qda_mode <- discrim_quad() %>%
set_engine('MASS') %>%
set_mode('classification')
qda_wf <- workflow() %>%
add_model(qda_mode) %>%
add_recipe(titanic_recipe)
qda_fit <- fit(qda_wf, titanic_training)
log_fit <- fit(log_wf, titanic_fold)
titanic_fold <- vfold_cv(titanic_training, v=10)
titanic_fold
log_fit <- fit_resamples(log_wf, titanic_fold)
lda_fit <- fit_resamples(lda_wf, titanic_fold)
qda_fit <- fit(qda_wf, titanic_fold)
qda_fit <- fit_resamples(qda_wf, titanic_fold)
?collect_metrics
collect_metrics(log_fit)
collect_metrics(log_fit$.metrics)
collect_metrics(c(log_fit, lda_fit, qda_fit))
collect_metrics(log_fit)
collect_metrics(log_fit)
collect_metrics(lda_fit)
collect_metrics(log_fit)
collect_metrics(lda_fit)
collect_metrics(qda_fit)
mx1 <- collect_metrics(log_fit)
mx2 <- collect_metrics(lda_fit)
mx3 <- collect_metrics(qda_fit)
rbind(mx1,mx2,mx3)
mx1 <- collect_metrics(log_fit)
mx2 <- collect_metrics(lda_fit)
mx3 <- collect_metrics(qda_fit)
bindtotal <- rbind(mx1,mx2,mx3)
show_best(bindtotal)
mx1 <- collect_metrics(log_fit)
mx2 <- collect_metrics(lda_fit)
mx3 <- collect_metrics(qda_fit)
#bindtotal <- rbind(mx1,mx2,mx3)
#show_best(bindtotal)
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
#bindtotal <- rbind(mx1,mx2,mx3)
#show_best(bindtotal)
lda_fit <- fit_resamples(lda_wf, titanic_fold)
lda_fit
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
show_best(mx1,mx2,mx3)
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
show_best(c(mx1,mx2,mx3))
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
show_best(r(mx1,mx2,mx3))
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
show_best(c(mx1,mx2,mx3))
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(log_fit, lda_fit, qda_fit) %>%
tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"))
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(log_fit, lda_fit, qda_fit) %>%
tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis")) %>%
select(model, mean, std_err)
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(log_fit, lda_fit, qda_fit) #%>%
#tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis")) %>%
s#elect(model, mean, std_err)
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(log_fit, lda_fit, qda_fit) #%>%
#tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis")) %>%
#select(model, mean, std_err)
results
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) #%>%
#tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis")) %>%
#select(model, mean, std_err)
results
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) #%>%
tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis")) %>%
#elect(model, mean, std_err)
results
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) #%>%
tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis")) %>%
select(model, mean, std_err)
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) #%>%
#tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis")) %>%
#select(model, mean, std_err)
results
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) #%>%
tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis")) %>%
#select(model, mean, std_err)
results
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) #%>%
tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis")) #%>%
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis")) #%>%
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"),2)) #%>%
select(model, mean, std_err)
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"),2)) #%>%
#select(model, mean, std_err)
results
? rep()
?rep
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) #%>%
#select(model, mean, std_err)
results
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
select(model, mean, std_err)
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
#select(model, mean, std_err)
results
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) #%>%
#select(model, mean, std_err)
results
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
select(c(model, mean, std_err))
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
select(c('model', 'mean', 'std_err'))
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
select('model', 'mean', 'std_err')
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
select(model, mean, std_err)
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
select(model, mean)
bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2))
bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
select(model, mean)
bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
select(model)
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
select(mean)
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2))
results
?select
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, mean)
results
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, mean, std_err)
results
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, mean, std_err)
results
select_by_one_std_err(results)
?select_by_one_std_err
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, mean, std_err)
results
show_best(results, metric = 'rmse')
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, mean, std_err)
results
show_best(results, metric = 'mean')
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, mean, std_err)
results
dplyr::show_best(results, metric = 'mean')
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, mean, std_err)
results
MASS::show_best(results, metric = 'mean')
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, mean, std_err)
results
tune::show_best(results, metric = 'mean')
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, mean, std_err)
results
tune::show_best(results, std_err, metric = 'mean')
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, mean, std_err)
results
library(tidymodels)
library(tidymodels)
library(MASS)
tidymodels_prefer()
library(tidymodels)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(corrr)
library(discrim)
library(poissonreg)
library(klaR)
library(pROC)
tidymodels_prefer()
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, .metric, mean, std_err)
results
lda_fit <- fit_resamples(lda_wf, titanic_fold)
log_new_fit <- fit(log_wf, titanic_training)
mx1 <- collect_metrics(log_fit) %>%
accuracy(truth = survived, estimate = .pred_class)
mx1 <- collect_metrics(log_fit) %>%
accuracy()
log_fit <- fit_resamples(log_wf, titanic_fold) %>%
accuracy(truth = survived, estimate = .pred_class)
log_fit <- fit_resamples(log_wf, titanic_fold)
log_acc <- predict(log_new_fit, new_data = titanic_testing, type = 'class') %>%
bind_cols(titanic_training %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
log_acc <- predict(log_new_fit, new_data = titanic_testing, type = 'class') %>%
bind_cols(titanic_testing %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
log_acc <- predict(log_new_fit, new_data = titanic_testing, type = 'class') %>%
bind_cols(titanic_testing %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
log_acc
mx1 <- collect_metrics(log_fit)
mx1
mx2 <- collect_metrics(lda_fit)
mx2
mx3 <- collect_metrics(qda_fit)
mx3
results <- bind_rows(mx1, mx2, mx3) %>%
tibble() %>% mutate(model = rep(c("Logistic Regression", "Linear Discrminant Analysis", "Quadratic Discrminant Analysis"), each = 2)) %>%
dplyr::select(model, .metric, mean, std_err)
results
